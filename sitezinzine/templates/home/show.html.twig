{% extends 'base.html.twig' %}
{% block title %}
    "√âmission : " ~
    {{ emission.titre }}
{% endblock %}
{% block body %}
    <style>
/* ========== G√âN√âRAL ========== */
.bodyemission,
.bodyemission *{
  box-sizing: border-box;
}

.bodyemission {
  background: linear-gradient(#E4013A, #B81C61);
  width: 100%;
  display: flex;
  flex-direction: column;
  font-family: "Montserrat Alternates", sans-serif;
  font-weight: 700;
  font-style: normal;
  position: relative;
  color: white;
  line-height: 1.5em;
  margin: 0 auto;
  padding: 0;
}

.bodyemission a,
.bodyemission .table-infos a {
  color: #E40039;
  font-weight: bold;
  text-decoration: none;
  transition: color 0.3s ease;
}

.bodyemission a:hover,
.bodyemission .table-infos a:hover {
  color: black;
}

.bodyemission .titre {
  text-align: center;
  margin: 10px;
}

.bodyemission .bottom img {
  width: 100%;
  display: block;
  margin-bottom: -1px;
}

/* ========== FICHE √âMISSION ========== */
.bodyemission .fiche-emission {
  max-width: 900px;
  width: calc(100% - 32px);   /* ‚úÖ √©vite les d√©bordements */
  margin: 2rem auto;
  background-color: #fff;
  color: #1C1C1A;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  padding: 1.5rem;
  font-family: "Montserrat Alternates", sans-serif;
}

.bodyemission .bloc-haut {
  display: flex;
  gap: 1.5rem;
  align-items: flex-start;
  flex-wrap: wrap;
}

.bodyemission .bloc-image img {
  width: 200px;
  border-radius: 6px;
  object-fit: cover;
  max-width: 100%;
  height: auto;
  display: block;
}

.bodyemission .bloc-texte {
  flex: 1;
  min-width: 0; /* ‚úÖ √©vite les overflow en flex */
}

.bodyemission .bloc-texte h1 {
  font-size: 1.6rem;
  margin-bottom: 1rem;
  color: #E40039;
  overflow-wrap: anywhere;
}

.bodyemission .descriptif {
  font-size: 1rem;
  line-height: 1.6;
  margin: 15px;
  overflow-wrap: anywhere;
}

.bodyemission .btn-back {
  display: inline-block;
  margin-bottom: 1rem;
  color: #E40039;
  font-weight: bold;
  text-decoration: none;
}

.bodyemission .btn-back:hover {
  text-decoration: underline;
}

/* ========== BLOC INFOS (TABLEAU) ========== */
.bodyemission .bloc-infos {
  margin-top: 2rem;
}

.bodyemission .table-infos {
  width: 100%;
  border-collapse: collapse;
  background-color: #f9f9f9;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.bodyemission .table-infos thead {
  border: 2px solid #E40039;
}

.bodyemission .table-infos th {
  background-color: #E40039;
  color: white;
  padding: 1rem;
  text-align: left;
  font-weight: bold;
  vertical-align: top;
  border-bottom: 2px solid #E40039;
}

.bodyemission .table-infos td {
  text-align: left;
  padding: 1rem;
  border-top: 1px solid #eee;
  border-bottom: 1px solid #eee;
  vertical-align: top;
  overflow-wrap: anywhere;
}

/* ========== CATEGORIE ========== */
.bodyemission .catemission {
  border: 2px solid black;
  overflow: hidden;
  border-radius: 8px;
  margin-top: 2rem;
  padding-bottom: 10px;
}

.bodyemission .catemission img {
  float: left;
  margin: 10px 20px 10px 10px;
  width: 250px;
  max-width: 100%;
  height: auto;
  display: block;
  border-radius: 8%;
}

/* ========== √âMISSION LI√âES / THEMES ========== */
.bodyemission .theme {
  text-align: center;
  background: white;
  color: black;
}

.bodyemission .themeemission {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  padding: 1rem;
  width: min(900px, 100%);   /* ‚úÖ pas de 80% fixe */
  margin: 0 auto;
}

/* (tes styles existants pour les boutons/carte th√®me restent) */

/* ========== LISTE √âMISSIONS LI√âES ========== */
.bodyemission .emission-row {
  display: flex;
  background-color: #fff;
  border-radius: 8px;
  padding: 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  align-items: center;
  gap: 1rem;
  color: #1C1C1A;
  margin-bottom: 1.5rem;
}

.bodyemission .emission-image img {
  width: 120px;
  height: auto;
  border-radius: 4px;
  object-fit: cover;
  display: block;
}

.bodyemission .emission-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  text-align: left;
  min-width: 0;
}

.bodyemission .emission-content h3 {
  margin: 0;
  font-size: 1.2em;
  color: #1C1C1A;
  overflow-wrap: anywhere;
}

.bodyemission .emission-content .date {
  font-size: 0.9em;
  color: #888;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.bodyemission .emission-content .description {
  font-size: 1em;
  color: #333;
  overflow-wrap: anywhere;
}

.bodyemission .emission-link {
  margin-left: auto;
  display: flex;
  align-items: center;
}

.bodyemission .listen-link {
  background-color: #E40039;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 0.4rem 0.8rem;
  font-weight: bold;
  cursor: pointer;
  transition: background-color 0.3s ease;
  white-space: nowrap;
}

.bodyemission .listen-link:hover {
  background-color: #c70030;
}

/* =========================
   THEME BUTTONS (fix style actif)
   ========================= */

/* le conteneur peut rester comme tu veux, ici je ne touche pas √† ta mise en page globale */
.bodyemission .theme-card-button{
  /* IMPORTANT : neutralise le style "button" natif */
  appearance: none;
  -webkit-appearance: none;
  border: 0 !important;
  outline: none;
  background: none;
  padding: 0;
  margin: 0;

  cursor: pointer;
  width: 180px;
  height: 120px;
  border-radius: 8px;
  overflow: hidden;
  position: relative;

  /* ton effet */
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.bodyemission .theme-card-button:hover{
  transform: scale(1.03);
}

/* enl√®ve l‚Äôoutline de focus ‚Äúmoche‚Äù (on remplace par un focus propre) */
.bodyemission .theme-card-button:focus{
  outline: none;
}
.bodyemission .theme-card-button:focus-visible{
  box-shadow: 0 0 0 3px rgba(228, 0, 57, 0.35);
}

/* fond image */
.bodyemission .theme-card-background{
  width: 100%;
  height: 100%;
  background-size: cover;
  background-position: center;
  display: flex;
  align-items: flex-end;
  justify-content: center;
}

/* bandeau (par d√©faut sombre) */
.bodyemission .theme-card-overlay{
  width: 100%;
  padding: 0.5rem;
  text-align: center;
  font-size: 1rem;
  font-weight: 700;
  color: #fff;

  background-color: rgba(0, 0, 0, 0.6);
  transition: background-color 0.2s ease;
}

/* ‚úÖ √©tat actif : bandeau rouge (ton style d‚Äôorigine) */
.bodyemission .theme-card-button.active .theme-card-overlay{
  background-color: #E40039 !important;
}

/* (optionnel) si tu veux que l‚Äôactif ressorte un peu sans changer ton rendu */
.bodyemission .theme-card-button.active{
  transform: scale(1.02);
}


/* ========== RESPONSIVE ========== */
@media (max-width: 768px) {
  .bodyemission .fiche-emission{
    width: calc(100% - 24px);
    padding: 1rem;
    margin: 1rem auto;
  }

  .bodyemission .bloc-haut {
    flex-direction: column;
    align-items: center;
  }

  .bodyemission .bloc-image img {
    width: min(320px, 100%);
  }

  .bodyemission .bloc-texte {
    text-align: center;
  }

  /* ‚úÖ TABLE ‚Üí en ‚Äúcards‚Äù */
  .bodyemission .table-infos thead{
    display: none;
  }

  .bodyemission .table-infos,
  .bodyemission .table-infos tbody,
  .bodyemission .table-infos tr,
  .bodyemission .table-infos td{
    display: block;
    width: 100%;
  }

  .bodyemission .table-infos tr{
    border: 2px solid #E40039;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 12px;
    background: #fff;
  }

  .bodyemission .table-infos td{
    border: none;
    border-top: 1px solid #eee;
    padding: 12px;
  }

  .bodyemission .table-infos td:first-child{
    border-top: none;
  }

  /* ‚úÖ CATEGORIE : on enl√®ve le float */
  .bodyemission .catemission{
    overflow: visible;
    text-align: center;
  }

  .bodyemission .catemission img{
    float: none;
    margin: 10px auto 14px;
    width: min(420px, 92%);
  }

  /* ‚úÖ related emissions rows */
  .bodyemission .emission-row{
    flex-direction: column;
    align-items: stretch;
  }

  .bodyemission .emission-image img{
    width: 100%;
    max-width: 520px;
    margin: 0 auto;
  }

  .bodyemission .emission-content{
    text-align: left;
  }

  .bodyemission .emission-link{
    margin-left: 0;
    margin-top: 10px;
    align-self: stretch;
  }

  .bodyemission .listen-link{
    width: 100%;
    text-align: center;
  }

  /* ‚úÖ CATEGORIE : descriptif plus lisible en mobile */
.bodyemission .catemission .descriptif{
  margin: 12px 14px;     /* √©vite ‚Äúcoll√© au cadre‚Äù */
  text-align: left;      /* au lieu de centr√© */
  font-size: 0.95rem;    /* un peu plus petit */
  line-height: 1.55;
}

/* Optionnel : si le H1 de cat√©gorie est trop gros en mobile */
.bodyemission .catemission .titre h1{
  font-size: 1.25rem;
  margin: 10px 0 6px;
}

/* ‚úÖ √âMISSION : descriptif non centr√© en mobile (optionnel) */
.bodyemission .bloc-texte .descriptif{
  text-align: left;
  font-size: 0.95rem;
  margin: 12px 0; /* au lieu de 15px partout */
}

.bodyemission #theme-filter-buttons{
    margin-top: 12px;
  }

}

/* Tr√®s petit */
@media (max-width: 420px){
  .bodyemission .bloc-texte h1{ font-size: 1.3rem; }
  .bodyemission .descriptif{ margin: 10px 0; }
  .bodyemission .emission-content .date{
    flex-direction: column;
    align-items: flex-start;
  }
}

    </style>
    <div class="bodyemission">

    <div class="fiche-emission">
        <a href="{{ app.request.headers.get('referer') ?? '/' }}" class="btn-back">‚Üê Retour</a>

        <div class="bloc-haut">
            <div class="bloc-image">
                {% if emission.thumbnail %}
                    <img src="{{ vich_uploader_asset(emission, 'thumbnailFile') }}" alt="Photo de {{ emission.titre }}">
                {% elseif emission.categorie.thumbnail %}
                    <img src="{{ vich_uploader_asset(emission.categorie, 'thumbnailFile', 'App\\Entity\\Categories') }}" alt="Photo de {{ emission.titre }}">
                {% elseif emission.theme.thumbnail is defined %}
                    <img src="{{ vich_uploader_asset(emission.theme, 'thumbnailFile', 'App\\Entity\\Theme') }}" alt="Photo de {{ emission.titre }}">
                {% else %}
                    <img src="/images/emission-zinzine.jpg" alt="Image par d√©faut">
                {% endif %}
            </div>

            <div class="bloc-texte">
                <h1>{{ emission.titre }}</h1>
                <div class="descriptif">
                    {{ emission.descriptif | raw }}
                </div>
            </div>
        </div> <!-- /.bloc-haut -->

        <div class="bloc-infos">
            <table class="table-infos">
                <thead>
                    <tr>
                        <th>Infos diverses</th>
                        <th>Horaire de passage</th>
                        <th>Liens</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <strong>Th√®me :</strong> {{ emission.theme.name }}<br>
                            <strong>R√©f√©rent¬∑es :</strong> {{ emission.ref }}
                        </td>
                        <td>
                            {{ emission.datepub|format_datetime('long', 'none', locale='fr') }}
                        </td>
                        <td>
                            {% if emission.url %}
                                <a href="{{ emission.url }}" target="_blank">üéß √âcouter</a><br>
                                <a href="{{ emission.url }}" download target="_blank">‚¨á T√©l√©charger</a>
                            {% else %}
                                Aucun lien disponible
                            {% endif %}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div> <!-- /.bloc-infos -->

        <div class="catemission">
            <div class="titre">
                <a href="{{ path('categorie.show', {'id': emission.categorie.id}) }}">
                    <h1>{{ emission.categorie.titre }}</h1>
                </a>
            </div>
            {% if emission.categorie.thumbnail %}
                <img src="{{ vich_uploader_asset(emission.categorie, 'thumbnailFile') }}" alt="Photo de {{ emission.categorie.titre }}">
            {% endif %}
            <div class="descriptif">
                {{ emission.categorie.descriptif | raw }}
            </div>
        </div> <!-- /.catemission -->
    </div> <!-- /.fiche-emission -->

    <img class="bottom" src="/images/top-content-dechire-D.gif">
<div class="theme">
    {# On passe au composant la liste des IDs de th√®mes du groupe #}
{{ component('related_emissions', {
  groupIds: themesInGroup|map(t => t.id),
  selected: [],
  page: 1
}) }}

       
    </div> <!-- /.theme -->
</div> <!-- /.bodyemission -->

{% endblock %}

                                        